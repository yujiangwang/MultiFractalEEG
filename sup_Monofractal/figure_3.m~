% Authors: Lucas França(1), Yujiang Wang(1,2,3)

% 1 Department of Clinical and Experimental Epilepsy, UCL Institute of Neurology,
% University College London, London, United Kingdom

% 2 Interdisciplinary Computing and Complex BioSystems (ICOS) research group,
% School of Computing Science, Newcastle University, Newcastle upon Tyne,
% United Kingdom

% 3 Institute of Neuroscience, Newcastle University, Newcastle upon Tyne,
% United Kingdom

% email address: lucas.franca.14@ucl.ac.uk, Yujiang.Wang@newcastle.ac.uk
% Website: https://lucasfr.github.io/, http://xaphire.de/

%% Results successfully reproduced by YW (20/July/2017)
%% External function such as dfa() and Higuchi_FD() were not checked in detail
clear
close all
clc
addpath(genpath('../libs/'))

%% LOADING EEG DATA

load('JR_12062011_1630_1730_ch1.mat')

%% PARAMETERS

segSize = 1024;


%% DFA AND DESCRIPTIVE STATISTICS

%can use parfor
tic
[dfaFD] = dfa_nr_meth(data,segSize,8,2); % 2 - dyadic scale
toc
tic
[dfaFDn] = dfa_nr_meth_n(data,segSize,8,2);
toc
tic
[mVal,stdVal,~] = mstdvar(data,2,512);
toc


%% HIGUCHI METHOD
tic
[HigFD] = higuchi_nr_meth(data,segSize,4);
toc
[HigFDn] = higuchi_nr_meth_n(data,segSize,4);


% %% PLOTTING THE FIGURES
%



fractalsMat = horzcat(dfaFD(:,4),dfaFDn(:,4),HigFD,HigFDn,stdVal(:,4),...
    mVal(:,4));

save('fractalsl.mat','fractalsMat','dfaFD','dfaFDn','series')


figure

subplot(2,1,1)
plot(2:2:2*length(dfaFD(:,4)),dfaFD(:,4),'Color',[202 0 32]./255,...
    'LineWidth',1)
hold on
plot(2:2:2*length(smoothdata(dfaFD(:,4),'movmedian',50)),...
    smoothdata(dfaFD(:,4),'movmedian',50),'Color',[0 0 0]./255,'LineWidth',2)
hold off
title('Variation of scaling exponent (with standardisation and sigmoid)')
xlim([2 3600])
ylim([1.3 1.9])
xlabel('Time (s)')
ylabel('h_{DFA}')
set(gca,'FontSize',20,'FontName','Times')
set(gca,'LineWidth',1.5)

subplot(2,1,2)
plot(2:2:2*length(dfaFDn(:,4)),dfaFDn(:,4),'Color',[5 113 176]./255,...
    'LineWidth',1)
hold on
plot(2:2:2*length(smoothdata(dfaFD(:,4),'movmedian',50)),...
    smoothdata(dfaFD(:,4),'movmedian',50),'Color',[0 0 0]./255,'LineWidth',2)
hold off
title('Variation of scaling exponent')
xlim([2 3600])
ylim([1.3 1.9])
xlabel('Time (s)')
ylabel('h_{DFA}')
set(gca,'FontSize',20,'FontName','Times')
set(gca,'LineWidth',1.5)

print -depsc2 -painters fract_dfa.eps
print -dpng fract_dfa.png


figure

subplot(2,1,1)
plot(2:2:2*length(fractalsMat(:,3)),fractalsMat(:,3),'Color',[202 0 32]./255,...
    'LineWidth',1)
hold on
plot(2:2:2*length(smoothdata(fractalsMat(:,3),'movmedian',50)),...
    smoothdata(fractalsMat(:,3),'movmedian',50),'Color',[0 0 0]./255,...
    'LineWidth',2)
hold off
title('Variation of scaling exponent (with standardisation and sigmoid)')
xlim([2 3600])
ylim([1 1.8])
xlabel('Time (s)')
ylabel('FD_{Hig}')
set(gca,'FontSize',20,'FontName','Times')
set(gca,'LineWidth',1.5)

subplot(2,1,2)
plot(2:2:2*length(fractalsMat(:,4)),fractalsMat(:,4),'Color',[5 113 176]./255,...
 





